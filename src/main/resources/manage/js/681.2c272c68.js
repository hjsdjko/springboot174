"use strict";(self["webpackChunkvue3_nb0"]=self["webpackChunkvue3_nb0"]||[]).push([[681],{58681:(e,l,a)=>{a.r(l),a.d(l,{default:()=>k});a(39524),a(30721),a(16158),a(63134),a(33510),a(41808),a(87547),a(8971),a(43448),a(86696),a(40073),a(1680),a(30826),a(3299),a(56505),a(98218),a(68838),a(36507);var t=a(67377),n=a(98479),u=(a(31250),a(51290)),i=a(86754),o=a(54432),r=(a(31818),a(51284),a(75014),a(52443),{class:"formModel_btn_box"});const d={__name:"formModel",emits:["formModelChange"],setup:function(e,l){var a,n=l.expose,i=l.emit,o=null===(a=(0,t.FN)())||void 0===a?void 0:a.appContext.config.globalProperties,d="emailregistercode",c="邮箱验证码",v=(0,u.iH)({}),f=(0,u.iH)({email:!1,role:!1,code:!1}),s=(0,u.iH)(!1),m=(0,u.iH)(!1),p=(0,u.iH)(""),g=(0,u.iH)({email:[{required:!0,message:"请输入",trigger:"blur"}],role:[{required:!0,message:"请输入",trigger:"blur"}],code:[{required:!0,message:"请输入",trigger:"blur"}]}),h=(0,u.iH)(null),w=(0,u.iH)(0),_=(0,u.iH)(""),b=function(){v.value={email:"",role:"",code:""}},k=function(){null===o||void 0===o||o.$http({url:"".concat(d,"/info/").concat(w.value),method:"get"}).then((function(e){new RegExp("../../../file","g");v.value=e.data.data,s.value=!0}))},y=(0,u.iH)(""),W=(0,u.iH)(""),C=(0,u.iH)(""),H=(0,u.iH)(""),U=(0,u.iH)(""),x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"add",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,n=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,o=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if(b(),e&&(w.value=e,_.value=l),"add"==l)m.value=!0,p.value="新增"+c,s.value=!0;else if("info"==l)m.value=!1,p.value="查看"+c,k();else if("edit"==l)m.value=!0,p.value="修改"+c,k();else if("cross"==l){for(var r in m.value=!0,p.value=a,t)"email"!=r?"role"!=r?"code"!=r||(v.value.code=t[r],f.value.code=!0):(v.value.role=t[r],f.value.role=!0):(v.value.email=t[r],f.value.email=!0);t&&(y.value=t),n&&(W.value=n),i&&(C.value=i),u&&(H.value=u),o&&(U.value=o),s.value=!0}};n({init:x});var $=function(){s.value=!1},z=function(){W.value;var e=JSON.parse(JSON.stringify(y.value)),l="",a="",t="";if("cross"==_.value&&""!=H.value)if(H.value.startsWith("["))l=null===o||void 0===o?void 0:o.$toolUtil.storageGet("userid"),a=e["id"],t=H.value.replace(/\[/,"").replace(/\]/,"");else{for(var n in e)n==H.value&&(e[n]=U.value);V(e)}h.value.validate((function(e){if(e)if(l&&a){v.value.crossuserid=l,v.value.crossrefid=a;var n={page:1,limit:1e3,crossuserid:v.value.crossuserid,crossrefid:v.value.crossrefid};null===o||void 0===o||o.$http({url:"".concat(d,"/page"),method:"get",params:n}).then((function(e){if(e.data.data.total>=t)return null===o||void 0===o||o.$toolUtil.message("".concat(C.value),"error"),!1;null===o||void 0===o||o.$http({url:"".concat(d,"/").concat(v.value.id?"update":"save"),method:"post",data:v.value}).then((function(e){null===o||void 0===o||o.$toolUtil.message("操作成功","success",(function(){s.value=!1,i("formModelChange")}))}))}))}else null===o||void 0===o||o.$http({url:"".concat(d,"/").concat(v.value.id?"update":"save"),method:"post",data:v.value}).then((function(e){null===o||void 0===o||o.$toolUtil.message("操作成功","success",(function(){s.value=!1,i("formModelChange")}))}))}))},V=function(e){null===o||void 0===o||o.$http({url:"".concat(W.value,"/update"),method:"post",data:e}).then((function(e){}))};return function(e,l){var a=(0,t.up)("el-input"),n=(0,t.up)("el-form-item"),u=(0,t.up)("el-col"),i=(0,t.up)("el-row"),o=(0,t.up)("el-form"),d=(0,t.up)("el-button"),c=(0,t.up)("el-dialog");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t.Wm)(c,{modelValue:s.value,"onUpdate:modelValue":l[3]||(l[3]=function(e){return s.value=e}),title:p.value,width:"80%","destroy-on-close":"",fullscreen:!1},(0,t.Nv)({default:(0,t.w5)((function(){return[(0,t.Wm)(o,{class:"formModel_form",ref_key:"formRef",ref:h,model:v.value,"label-width":"$template2.back.add.form.base.labelWidth",rules:g.value},{default:(0,t.w5)((function(){return[(0,t.Wm)(i,null,{default:(0,t.w5)((function(){return[(0,t.Wm)(u,{span:12},{default:(0,t.w5)((function(){return[(0,t.Wm)(n,{label:"邮箱",prop:"email"},{default:(0,t.w5)((function(){return[(0,t.Wm)(a,{class:"list_inp",modelValue:v.value.email,"onUpdate:modelValue":l[0]||(l[0]=function(e){return v.value.email=e}),placeholder:"邮箱",type:"text",readonly:!(m.value&&!f.value.email)},null,8,["modelValue","readonly"])]})),_:1})]})),_:1}),(0,t.Wm)(u,{span:12},{default:(0,t.w5)((function(){return[(0,t.Wm)(n,{label:"角色",prop:"role"},{default:(0,t.w5)((function(){return[(0,t.Wm)(a,{class:"list_inp",modelValue:v.value.role,"onUpdate:modelValue":l[1]||(l[1]=function(e){return v.value.role=e}),placeholder:"角色",type:"text",readonly:!(m.value&&!f.value.role)},null,8,["modelValue","readonly"])]})),_:1})]})),_:1}),(0,t.Wm)(u,{span:12},{default:(0,t.w5)((function(){return[(0,t.Wm)(n,{label:"验证码",prop:"code"},{default:(0,t.w5)((function(){return[(0,t.Wm)(a,{class:"list_inp",modelValue:v.value.code,"onUpdate:modelValue":l[2]||(l[2]=function(e){return v.value.code=e}),placeholder:"验证码",type:"text",readonly:!(m.value&&!f.value.code)},null,8,["modelValue","readonly"])]})),_:1})]})),_:1})]})),_:1})]})),_:1},8,["model","rules"])]})),_:2},[m.value||"logistics"==_.value||"reply"==_.value?{name:"footer",fn:(0,t.w5)((function(){return[(0,t._)("span",r,[(0,t.Wm)(d,{class:"formModel_cancel",onClick:$},{default:(0,t.w5)((function(){return[(0,t.Uk)("取消")]})),_:1}),(0,t.Wm)(d,{class:"formModel_confirm",type:"primary",onClick:z},{default:(0,t.w5)((function(){return[(0,t.Uk)(" 提交 ")]})),_:1})])]})),key:"0"}:void 0]),1032,["modelValue","title"])])}}};var c=a(57326);const v=(0,c.Z)(d,[["__scopeId","data-v-382fa26e"]]),f=v;var s=function(e){return(0,t.dD)("data-v-f6dd105c"),e=e(),(0,t.Cn)(),e},m={class:"app-contain"},p={class:"list_search_view"},g=s((function(){return(0,t._)("br",null,null,-1)})),h={class:"btn_view"},w=s((function(){return(0,t._)("br",null,null,-1)}));const _={__name:"list",setup:function(e){var l,a=null===(l=(0,t.FN)())||void 0===l?void 0:l.appContext.config.globalProperties,r="emailregistercode",d="邮箱验证码";(0,i.yj)();(0,t.bv)((function(){}));var c=(0,u.iH)(null),v=(0,u.iH)(null),s=(0,u.iH)({page:1,limit:20,sort:"id",order:"desc"}),_=(0,u.iH)({}),b=(0,u.iH)([]),k=(0,u.iH)(!1),y=function(e){(0,t.Y3)((function(){v.value.clearSelection(),v.value.toggleRowSelection(e)}))},W=function(){k.value=!0;var e=JSON.parse(JSON.stringify(s.value));e["sort"]="id",e["order"]="desc",null===a||void 0===a||a.$http({url:"".concat(r,"/page"),method:"get",params:e}).then((function(e){k.value=!1,c.value=e.data.data.list,U.value=Number(e.data.data.total)}))},C=function(e){var l=(0,u.iH)([]);if(e)l.value=[e];else{if(!b.value.length)return!1;for(var t in b.value)l.value.push(b.value[t].id)}o.T.confirm("是否删除选中".concat(d),"提示",{confirmButtonText:"是",cancelButtonText:"否",type:"warning"}).then((function(){null===a||void 0===a||a.$http({url:"".concat(r,"/delete"),method:"post",data:l.value}).then((function(e){null===a||void 0===a||a.$toolUtil.message("删除成功","success",(function(){W()}))}))}))},H=function(e){b.value=e},U=(0,u.iH)(0),x=(0,u.iH)(["total","prev","pager","next","sizes","jumper"]),$=function(e){s.value.limit=e,W()},z=function(e){s.value.page=e,W()},V=function(){s.value.page=s.value.page-1,W()},j=function(){s.value.page=s.value.page+1,W()},q=function(e,l){return null===a||void 0===a?void 0:a.$toolUtil.isAuth(e,l)},M=function(){s.value.page=1,W()},N=(0,u.iH)(null),S=function(){M()},R=function(){N.value.init()},J=function(){b.value.length&&N.value.init(b.value[0].id,"edit")},O=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e?N.value.init(e,"info"):b.value.length&&N.value.init(b.value[0].id,"info")},D=function(){W()};return D(),function(e,l){var a=(0,t.up)("el-form"),u=(0,t.up)("el-button"),i=(0,t.up)("el-table-column"),o=(0,t.up)("el-table"),r=(0,t.up)("el-pagination"),d=(0,t.Q2)("loading");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t._)("div",m,[(0,t._)("div",p,[(0,t.Wm)(a,{model:_.value,class:"search_form"},null,8,["model"]),g,(0,t._)("div",h,[q("emailregistercode","新增")?((0,t.wg)(),(0,t.j4)(u,{key:0,type:"success",onClick:R},{default:(0,t.w5)((function(){return[(0,t.Uk)("新增")]})),_:1})):(0,t.kq)("",!0),q("emailregistercode","查看")?((0,t.wg)(),(0,t.j4)(u,{key:1,type:"info",disabled:1!=b.value.length,onClick:l[0]||(l[0]=function(e){return O(null)})},{default:(0,t.w5)((function(){return[(0,t.Uk)("详情")]})),_:1},8,["disabled"])):(0,t.kq)("",!0),q("emailregistercode","修改")?((0,t.wg)(),(0,t.j4)(u,{key:2,type:"primary",disabled:1!=b.value.length,onClick:J},{default:(0,t.w5)((function(){return[(0,t.Uk)("修改")]})),_:1},8,["disabled"])):(0,t.kq)("",!0),q("emailregistercode","删除")?((0,t.wg)(),(0,t.j4)(u,{key:3,type:"danger",disabled:!b.value.length,onClick:l[1]||(l[1]=function(e){return C(null)})},{default:(0,t.w5)((function(){return[(0,t.Uk)("删除")]})),_:1},8,["disabled"])):(0,t.kq)("",!0)])]),w,q("emailregistercode","查看")?(0,t.wy)(((0,t.wg)(),(0,t.j4)(o,{key:0,border:"",stripe:!0,onSelectionChange:H,ref_key:"table",ref:v,data:c.value,onRowClick:y},{default:(0,t.w5)((function(){return[(0,t.Wm)(i,{resizable:!0,align:"left","header-align":"left",type:"selection",width:"55"}),(0,t.Wm)(i,{label:"序号",width:"70",resizable:!0,sortable:!1,align:"left","header-align":"left"},{default:(0,t.w5)((function(e){return[(0,t.Uk)((0,n.zw)(e.$index+1),1)]})),_:1}),(0,t.Wm)(i,{resizable:!0,sortable:!1,align:"left","header-align":"left",label:"邮箱"},{default:(0,t.w5)((function(e){return[(0,t.Uk)((0,n.zw)(e.row.email),1)]})),_:1}),(0,t.Wm)(i,{resizable:!0,sortable:!1,align:"left","header-align":"left",label:"角色"},{default:(0,t.w5)((function(e){return[(0,t.Uk)((0,n.zw)(e.row.role),1)]})),_:1}),(0,t.Wm)(i,{resizable:!0,sortable:!1,align:"left","header-align":"left",label:"验证码"},{default:(0,t.w5)((function(e){return[(0,t.Uk)((0,n.zw)(e.row.code),1)]})),_:1}),(0,t.Wm)(i,{label:"操作",width:"300",resizable:!0,sortable:!1,align:"left","header-align":"left"},{default:(0,t.w5)((function(e){return[q("emailregistercode","查看")?((0,t.wg)(),(0,t.j4)(u,{key:0,type:"info",onClick:function(l){return O(e.row.id)}},{default:(0,t.w5)((function(){return[(0,t.Uk)("详情")]})),_:2},1032,["onClick"])):(0,t.kq)("",!0)]})),_:1})]})),_:1},8,["data"])),[[d,k.value]]):(0,t.kq)("",!0),(0,t.Wm)(r,{background:"",layout:x.value.join(","),total:U.value,"page-size":s.value.limit,"prev-text":"<","next-text":">","hide-on-single-page":!0,style:{width:"100%",padding:"0",margin:"20px 0 0",whiteSpace:"nowrap",color:"#333",fontWeight:"500"},onSizeChange:$,onCurrentChange:z,onPrevClick:V,onNextClick:j},null,8,["layout","total","page-size"])]),(0,t.Wm)(f,{ref_key:"formRef",ref:N,onFormModelChange:S},null,512)])}}},b=(0,c.Z)(_,[["__scopeId","data-v-f6dd105c"]]),k=b}}]);
//# sourceMappingURL=681.2c272c68.js.map